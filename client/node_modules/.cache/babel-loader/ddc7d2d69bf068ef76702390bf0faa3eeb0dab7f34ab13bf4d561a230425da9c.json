{"ast":null,"code":"import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react';\n///https://redux-toolkit.js.org/rtk-query/usage/customizing-queries#:~:text=RTK%20Query%20expects%20a%20baseQuery,to%20return%20such%20an%20object.\nexport const apiSlice = createApi({\n  reducerPath: 'api',\n  baseQuery: fetchBaseQuery({\n    baseUrl: '/draft'\n  }),\n  endpoints: builder => ({\n    getRedDraft: builder.query({\n      ///url needs  to be fixed, ignore for now\n      query: channel => `${channel}/red-draft`,\n      async onCacheEntryAdded(arg, _ref) {\n        let {\n          updateCachedData,\n          cacheDataLoaded,\n          cacheEntryRemoved\n        } = _ref;\n        ///should this come from proxy?\n        const ws = new WebSocket('ws://localhost:8000');\n        try {\n          await cacheDataLoaded;\n          const listener = event => {\n            const data = JSON.parse(event.data);\n            return updateCachedData(draft => {\n              draft.push(data);\n            });\n          };\n          ws.addEventListener('message', listener);\n        } catch {}\n        await cacheEntryRemoved;\n        ws.close();\n      }\n    }),\n    getBlueDraft: builder.query({\n      query: matchid => ({\n        url: `${matchid}/blue-draft`\n      })\n    })\n  })\n});\nexport const {\n  useGetRedDraftQuery\n} = apiSlice;\nexport const useGetBlueDraftQuery = apiSlice.endpoints.getRedDraft;","map":{"version":3,"names":["createApi","fetchBaseQuery","apiSlice","reducerPath","baseQuery","baseUrl","endpoints","builder","getRedDraft","query","channel","onCacheEntryAdded","arg","_ref","updateCachedData","cacheDataLoaded","cacheEntryRemoved","ws","WebSocket","listener","event","data","JSON","parse","draft","push","addEventListener","close","getBlueDraft","matchid","url","useGetRedDraftQuery","useGetBlueDraftQuery"],"sources":["C:/Users/jamar/Documents/Hobbies/Coding/In-House_Draft/draftlol/client/src/App/Slices/apiSlice.ts"],"sourcesContent":["import { createApi, fetchBaseQuery } from '@reduxjs/toolkit/query/react'\r\nimport { DraftListRequest,Channel} from '../Types/champ-select-types'\r\n\r\n\r\n///https://redux-toolkit.js.org/rtk-query/usage/customizing-queries#:~:text=RTK%20Query%20expects%20a%20baseQuery,to%20return%20such%20an%20object.\r\nexport const apiSlice = createApi({\r\n  reducerPath: 'api',\r\n  baseQuery: fetchBaseQuery({baseUrl:'/draft'}),\r\n  endpoints: (builder) => ({\r\n    getRedDraft: builder.query<DraftListRequest[], Channel>({\r\n      ///url needs  to be fixed, ignore for now\r\n      query: (channel) => `${channel}/red-draft`,\r\n      async onCacheEntryAdded(\r\n        arg,\r\n        {updateCachedData,cacheDataLoaded,cacheEntryRemoved}\r\n      ){\r\n        ///should this come from proxy?\r\n        const ws = new WebSocket('ws://localhost:8000')\r\n        try{\r\n          await cacheDataLoaded\r\n\r\n          const listener = (event:MessageEvent) => {\r\n            const data:DraftListRequest = JSON.parse(event.data)\r\n            return updateCachedData((draft) => {\r\n              draft.push(data)\r\n            })\r\n          } \r\n          ws.addEventListener('message',listener)\r\n        } catch {}\r\n        await cacheEntryRemoved\r\n        ws.close()\r\n      } \r\n    }),\r\n    getBlueDraft: builder.query({\r\n        query: (matchid) => ({url:`${matchid}/blue-draft`})\r\n      }),\r\n  }),\r\n})\r\n\r\nexport const {useGetRedDraftQuery} = apiSlice\r\nexport const useGetBlueDraftQuery = apiSlice.endpoints.getRedDraft\r\n\r\n"],"mappings":"AAAA,SAASA,SAAS,EAAEC,cAAc,QAAQ,8BAA8B;AAIxE;AACA,OAAO,MAAMC,QAAQ,GAAGF,SAAS,CAAC;EAChCG,WAAW,EAAE,KAAK;EAClBC,SAAS,EAAEH,cAAc,CAAC;IAACI,OAAO,EAAC;EAAQ,CAAC,CAAC;EAC7CC,SAAS,EAAGC,OAAO,KAAM;IACvBC,WAAW,EAAED,OAAO,CAACE,KAAK,CAA8B;MACtD;MACAA,KAAK,EAAGC,OAAO,IAAM,GAAEA,OAAQ,YAAW;MAC1C,MAAMC,iBAAiBA,CACrBC,GAAG,EAAAC,IAAA,EAEJ;QAAA,IADC;UAACC,gBAAgB;UAACC,eAAe;UAACC;QAAiB,CAAC,GAAAH,IAAA;QAEpD;QACA,MAAMI,EAAE,GAAG,IAAIC,SAAS,CAAC,qBAAqB,CAAC;QAC/C,IAAG;UACD,MAAMH,eAAe;UAErB,MAAMI,QAAQ,GAAIC,KAAkB,IAAK;YACvC,MAAMC,IAAqB,GAAGC,IAAI,CAACC,KAAK,CAACH,KAAK,CAACC,IAAI,CAAC;YACpD,OAAOP,gBAAgB,CAAEU,KAAK,IAAK;cACjCA,KAAK,CAACC,IAAI,CAACJ,IAAI,CAAC;YAClB,CAAC,CAAC;UACJ,CAAC;UACDJ,EAAE,CAACS,gBAAgB,CAAC,SAAS,EAACP,QAAQ,CAAC;QACzC,CAAC,CAAC,MAAM,CAAC;QACT,MAAMH,iBAAiB;QACvBC,EAAE,CAACU,KAAK,CAAC,CAAC;MACZ;IACF,CAAC,CAAC;IACFC,YAAY,EAAErB,OAAO,CAACE,KAAK,CAAC;MACxBA,KAAK,EAAGoB,OAAO,KAAM;QAACC,GAAG,EAAE,GAAED,OAAQ;MAAY,CAAC;IACpD,CAAC;EACL,CAAC;AACH,CAAC,CAAC;AAEF,OAAO,MAAM;EAACE;AAAmB,CAAC,GAAG7B,QAAQ;AAC7C,OAAO,MAAM8B,oBAAoB,GAAG9B,QAAQ,CAACI,SAAS,CAACE,WAAW"},"metadata":{},"sourceType":"module","externalDependencies":[]}